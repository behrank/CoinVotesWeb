@page "/dashboard/symbols/add"
@using CoinVotesWeb.Components.Layout
@layout DashboardLayout
@inject IJSRuntime JSRuntime
@inject NavigationManager NavigationManager

<PageTitle>Add Symbol - CoinVotes</PageTitle>

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card bg-dark text-light">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Add New Symbol</h5>
                    <button class="btn btn-outline-light" @onclick="GoBack">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                </div>
                <div class="card-body">
                    <form id="symbolAddForm">
                        <div class="mb-3">
                            <label for="symbolName" class="form-label">Symbol Name</label>
                            <input type="text" class="form-control bg-dark text-light" id="symbolName" required>
                        </div>
                        <div class="mb-3">
                            <label for="symbolUsdt" class="form-label">Symbol USDT</label>
                            <input type="text" class="form-control bg-dark text-light" id="symbolUsdt" required>
                        </div>
                        <div class="mb-3">
                            <label for="symbolCode" class="form-label">Code</label>
                            <input type="text" class="form-control bg-dark text-light" id="symbolCode" required>
                        </div>
                        <div class="mb-3">
                            <label for="symbolOrderNo" class="form-label">Order No</label>
                            <input type="number" class="form-control bg-dark text-light" id="symbolOrderNo" required>
                        </div>
                        <div class="mb-3">
                            <label for="symbolStatus" class="form-label">Status</label>
                            <select class="form-select bg-dark text-light" id="symbolStatus">
                                <option value="true">Active</option>
                                <option value="false">Inactive</option>
                            </select>
                        </div>
                        <div class="d-flex justify-content-end gap-2">
                            <button type="button" class="btn btn-outline-light" @onclick="GoBack">Cancel</button>
                            <button type="submit" class="btn btn-primary">Add Symbol</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('symbolAddForm');
        if (form) {
            form.addEventListener('submit', handleSubmit);
        }
    });

    async function handleSubmit(event) {
        event.preventDefault();
        
        try {
            const formData = {
                name: document.getElementById('symbolName').value,
                symbolUsdt: document.getElementById('symbolUsdt').value,
                code: document.getElementById('symbolCode').value,
                orderNo: document.getElementById('symbolOrderNo').value,
                isActive: document.getElementById('symbolStatus').value === 'true'
            };

            const response = await fetch('/api/SymbolsApi', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            });

            if (!response.ok) {
                throw new Error('Failed to add symbol');
            }

            alert('Symbol added successfully');
            window.location.href = '/dashboard/symbols';
        } catch (error) {
            console.error('Error adding symbol:', error);
            alert('Failed to add symbol. Please try again.');
        }
    }
</script>

@code {
    private void GoBack()
    {
        NavigationManager.NavigateTo("/dashboard/symbols");
    }
} 